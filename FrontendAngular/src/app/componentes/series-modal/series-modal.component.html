<div class="modal-dialog modal-lg">
  <div class="modal-content">
    <div class="modal-header bg-primary text-white">
      <h5 class="modal-title" id="miModalLabel">
        {{ editar ? 'Editar Serie' : 'Nueva Serie' }}
      </h5>
      <button type="button" class="btn-close btn-close-white" (click)="activeModal.dismiss()" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <form [formGroup]="formSeries">
        <div class="row">
          <div class="col-md-8">
            <div class="form-floating mb-3">
              <input formControlName="titulo" type="text" class="form-control"
                     [class.is-invalid]="titulo?.invalid && (titulo?.dirty)"
                     id="titulo" placeholder="Titulo">
              <label for="titulo">Título</label>
              @if (titulo?.invalid && (titulo?.dirty)) {
                <div class="invalid-feedback">
                  @if (titulo?.errors?.['required']) {
                    <div>El título es requerido</div>
                  }
                </div>
              }
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-floating mb-3">
              <input formControlName="emision" type="text" class="form-control"
                     [class.is-invalid]="emision?.invalid && (emision?.dirty)"
                     id="emision" placeholder="Fecha emision">
              <label for="emision">Fecha emisión</label>
              @if (emision?.invalid && (emision?.dirty)) {
                <div class="invalid-feedback">
                  @if (emision?.errors?.['required']) {
                    <div>La fecha de emisión es requerida</div>
                  }
                </div>
              }
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <div class="form-floating mb-3">
              <input formControlName="capitulos" type="number" class="form-control"
                     [class.is-invalid]="capitulos?.invalid && (capitulos?.dirty)"
                     id="capitulos" placeholder="Episodios">
              <label for="capitulos">Episodios</label>
              @if (capitulos?.invalid && (capitulos?.dirty)) {
                <div class="invalid-feedback">
                  @if (capitulos?.errors?.['required']) {
                    <div>El número de episodios es requerido</div>
                  }
                  @if (capitulos?.errors?.['min']) {
                    <div>El número de episodios debe ser mayor que 0</div>
                  }
                </div>
              }
            </div>
          </div>
          <div class="col-md-8">
            <div class="form-floating mb-3">
              <input formControlName="imagenes" type="text" class="form-control" id="imagenes" placeholder="URL de imagen">
              <label for="imagenes">URL de imagen</label>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <img [src]="imagen?.value" class="img-fluid rounded" alt="Serie Image">
          </div>

          <div class="col-md-8">
            <div class="form-floating">
              <textarea formControlName="sinopsis" rows="4" class="form-control"
                        [class.is-invalid]="sinopsis?.invalid && (sinopsis?.dirty)"
                        id="sinopsis" placeholder="Sinopsis"></textarea>
              <label for="sinopsis">Sinopsis</label>
              @if (sinopsis?.invalid && (sinopsis?.dirty)) {
                <div class="invalid-feedback">
                  @if (sinopsis?.errors?.['required']) {
                    <div>La sinopsis es requerida</div>
                  }
                </div>
              }
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-8">
            <div class="mt-2">
              @for (categoria of listaCategorias; track $index) {
                <span class="badge bg-primary me-2 mb-2" style="cursor: pointer" (click)="eliminarCategoria(categoria)">
                  {{ categoria }} ×
                </span>
              }
            </div>
          </div>
          <div class="col-md-4">
            <form [formGroup]="anadirCategoria" class="d-flex">
              <div class="form-floating flex-grow-1 me-2">
                <input style="width: auto" type="text" class="form-control"
                       id="nuevaCategoria" formControlName="nuevaCategoria"
                       placeholder="Nueva categoria">
                <label for="nuevaCategoria">Nueva categoría</label>
              </div>
              <button
                type="button"
                class="btn btn-success"
                (click)="anadirNuevaCategoria()"
                [disabled]="!anadirCategoria.valid">
                <fa-icon [icon]="faPlusCircle"></fa-icon>
              </button>
            </form>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="activeModal.dismiss()">Cerrar</button>
      <button
        type="button"
        class="btn btn-primary"
        (click)="onSubmit()"
        [disabled]="formSeries.invalid">
        Guardar
      </button>
    </div>
  </div>
</div>
